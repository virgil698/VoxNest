# VoxNest æ’ä»¶ç³»ç»Ÿæ¶æ„è®¾è®¡

## è®¾è®¡ç›®æ ‡

### æ ¸å¿ƒç›®æ ‡
- **æ¨¡å—åŒ–**: åŠŸèƒ½å®Œå…¨è§£è€¦ï¼Œç‹¬ç«‹å¼€å‘å’Œéƒ¨ç½²
- **çƒ­æ’æ‹”**: è¿è¡Œæ—¶åŠ¨æ€åŠ è½½å’Œå¸è½½æ’ä»¶
- **æ ‡å‡†åŒ–**: ç»Ÿä¸€çš„æ’ä»¶å¼€å‘æ¥å£å’Œè§„èŒƒ
- **æ€§èƒ½**: æœ€å°åŒ–æ’ä»¶å¯¹ç³»ç»Ÿæ€§èƒ½çš„å½±å“
- **å…¨æ ˆæ‰©å±•**: å‰åç«¯ç»Ÿä¸€çš„æ‰©å±•æ¶æ„

## æ¶æ„æ¦‚è§ˆ

### æ•´ä½“æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å‰ç«¯æ‰©å±•æ¡†æ¶                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Extension Framework â”‚ Slot Manager â”‚ Integration API       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Extension Discovery â”‚ Extension Loader â”‚ Theme Manager     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   VoxNest Core Framework                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Plugin Manager  â”‚  Event Bus  â”‚  Service Registry  â”‚  API  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Plugin Runtime                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Plugin A  â”‚  Plugin B  â”‚  Plugin C  â”‚  Plugin D  â”‚  ...   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### å‰ç«¯æ‰©å±•æ¶æ„
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    React åº”ç”¨å±‚                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Slot Renderer â”‚ Component Registry â”‚ Route Manager        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              Extension Framework Core                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Integration Manager â”‚ Lifecycle Hooks â”‚ Context Provider   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚               å†…ç½®é›†æˆ (Built-in Integrations)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  React â”‚ DevTools â”‚ Layout â”‚ Style â”‚ Router â”‚ ...          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                   æ‰©å±•å‘ç°ä¸åŠ è½½                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Extension Discovery â”‚ Extension Loader â”‚ Dynamic Import    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å‰ç«¯æ‰©å±•æ¡†æ¶è¯¦ç»†è®¾è®¡

### æ ¸å¿ƒæ¦‚å¿µ

#### 1. æ‰©å±•æ¡†æ¶ (Extension Framework)
æ‰©å±•æ¡†æ¶æ˜¯å‰ç«¯æ’ä»¶ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œè´Ÿè´£ç®¡ç†æ‰©å±•çš„ç”Ÿå‘½å‘¨æœŸã€é›†æˆæ³¨å†Œå’Œç»„ä»¶æ§½ä½ã€‚

```typescript
interface ExtensionFramework {
  status: 'initializing' | 'ready' | 'error';
  config: VoxNestConfig;
  slots: SlotManager;
  integrations: IntegrationManager;
  logger: Logger;

  initialize(config?: VoxNestConfig): Promise<void>;
  register(integration: Integration): void;
  destroy(): Promise<void>;
  getStats(): any;
}
```

#### 2. é›†æˆç³»ç»Ÿ (Integration API)
é›†æˆæ˜¯å¯æ’æ‹”çš„åŠŸèƒ½æ¨¡å—ï¼Œé€šè¿‡é’©å­æœºåˆ¶æ‰©å±•æ¡†æ¶åŠŸèƒ½ã€‚æ”¯æŒä»¥ä¸‹ç”Ÿå‘½å‘¨æœŸé’©å­ï¼š

- **framework:ready**: æ¡†æ¶åˆå§‹åŒ–å®Œæˆ
- **components:ready**: ç»„ä»¶ç³»ç»Ÿå°±ç»ª  
- **app:start**: åº”ç”¨å¯åŠ¨å‰
- **app:started**: åº”ç”¨å¯åŠ¨å
- **app:destroy**: åº”ç”¨é”€æ¯

```typescript
interface Integration {
  name: string;
  hooks?: {
    'framework:ready'?: (context: IntegrationContext) => void | Promise<void>;
    'components:ready'?: (context: IntegrationContext) => void | Promise<void>;
    'app:start'?: (context: IntegrationContext) => void | Promise<void>;
    'app:started'?: (context: IntegrationContext) => void | Promise<void>;
    'app:destroy'?: (context: IntegrationContext) => void | Promise<void>;
  };
}
```

#### 3. æ§½ä½ç®¡ç† (Slot Manager)
æ§½ä½ç³»ç»Ÿå…è®¸åœ¨é¢„å®šä¹‰çš„ä½ç½®åŠ¨æ€æ³¨å†Œå’Œæ¸²æŸ“ç»„ä»¶ã€‚

```typescript
interface SlotManager {
  register(slotId: string, registration: ComponentRegistration): void;
  unregister(slotId: string, source: string): void;
  unregisterBySource(source: string): void;
  getComponents(slotId: string): ComponentRegistration[];
  render(slotId: string, props?: any): React.ReactNode;
}
```

### å†…ç½®é›†æˆè¯¦è§£

#### 1. React é›†æˆ (React Integration)
æä¾› React ç‰¹å®šçš„æ‰©å±•æ”¯æŒï¼ŒåŒ…æ‹¬é”™è¯¯è¾¹ç•Œã€æ‚¬å¿µå›é€€ã€å¼€å‘å·¥å…·ç­‰ã€‚

æ ‡å‡†æ§½ä½ï¼š
- `react:error-boundary`: React é”™è¯¯è¾¹ç•Œ
- `react:suspense-fallback`: æ‚¬å¿µå›é€€ç»„ä»¶
- `react:dev-tools`: React å¼€å‘å·¥å…·

#### 2. å¸ƒå±€é›†æˆ (Layout Integration)
å®šä¹‰æ ‡å‡†çš„å¸ƒå±€æ§½ä½ä½“ç³»ï¼Œæ”¯æŒçµæ´»çš„é¡µé¢å¸ƒå±€æ‰©å±•ã€‚

æ ‡å‡†æ§½ä½ï¼š
- `layout:header`: é¡µé¢å¤´éƒ¨
- `layout:header.left/center/right`: å¤´éƒ¨åŒºåŸŸç»†åˆ†
- `layout:sidebar`: ä¾§è¾¹æ 
- `layout:sidebar.top/bottom`: ä¾§è¾¹æ åŒºåŸŸç»†åˆ†
- `layout:content`: ä¸»å†…å®¹åŒº
- `layout:content.before/after`: å†…å®¹åŒºåŸŸæ‰©å±•
- `layout:footer`: é¡µé¢åº•éƒ¨
- `layout:footer.left/center/right`: åº•éƒ¨åŒºåŸŸç»†åˆ†

#### 3. æ ·å¼é›†æˆ (Style Integration)
ç®¡ç†ä¸»é¢˜å˜é‡å’ŒåŠ¨æ€æ ·å¼æ³¨å…¥ã€‚

CSS å˜é‡ï¼š
```css
:root {
  --voxnest-primary: #1890ff;
  --voxnest-success: #52c41a;
  --voxnest-warning: #faad14;
  --voxnest-error: #f5222d;
  --voxnest-bg: #ffffff;
  --voxnest-text: #333333;
  --voxnest-border: #d9d9d9;
  --voxnest-radius: 6px;
  --voxnest-shadow: 0 2px 8px rgba(0,0,0,0.15);
}
```

#### 4. å¼€å‘å·¥å…·é›†æˆ (DevTools Integration)
ä»…åœ¨å¼€å‘æ¨¡å¼ä¸‹å¯ç”¨ï¼Œæä¾›è°ƒè¯•å’Œæ€§èƒ½ç›‘æ§å·¥å…·ã€‚

å¿«æ·é”®ï¼š
- `Ctrl+Shift+D`: æ‰“å¼€è°ƒè¯•é¢æ¿
- `Ctrl+Shift+S`: æŸ¥çœ‹æ¡†æ¶çŠ¶æ€

#### 5. è·¯ç”±é›†æˆ (Router Integration)
æ”¯æŒè·¯ç”±å˜åŒ–ç›‘å¬å’Œç›¸å…³é’©å­ã€‚

æ ‡å‡†æ§½ä½ï¼š
- `router:before-route-change`: è·¯ç”±å˜åŒ–å‰
- `router:after-route-change`: è·¯ç”±å˜åŒ–å
- `router:route-error`: è·¯ç”±é”™è¯¯å¤„ç†

### æ‰©å±•å‘ç°ä¸åŠ è½½

#### æ‰©å±•å‘ç° (Extension Discovery)
è‡ªåŠ¨å‘ç° `/public/extensions` ç›®å½•ä¸­çš„æ’ä»¶å’Œä¸»é¢˜ï¼š

```
/public/extensions/
â”œâ”€â”€ plugins/
â”‚   â””â”€â”€ example-plugin/
â”‚       â”œâ”€â”€ manifest.json
â”‚       â”œâ”€â”€ index.js
â”‚       â”œâ”€â”€ plugin.js
â”‚       â””â”€â”€ styles.css
â””â”€â”€ themes/
    â””â”€â”€ dark-theme/
        â”œâ”€â”€ manifest.json
        â””â”€â”€ theme.css
```

æ‰©å±•æ¸…å•æ ¼å¼ï¼š
```json
{
  "id": "example-plugin",
  "name": "ç¤ºä¾‹æ’ä»¶",
  "version": "1.0.0",
  "type": "plugin|theme",
  "entry": "index.js",
  "styles": ["styles.css"],
  "scripts": ["plugin.js"],
  "config": {},
  "enabled": true
}
```

#### æ‰©å±•åŠ è½½ (Extension Loader)
æ”¯æŒåŠ¨æ€åŠ è½½æ‰©å±•èµ„æºï¼š

1. **æ ·å¼åŠ è½½**: åŠ¨æ€åˆ›å»º `<link>` æ ‡ç­¾åŠ è½½ CSS
2. **è„šæœ¬åŠ è½½**: åŠ¨æ€åˆ›å»º `<script>` æ ‡ç­¾åŠ è½½ JS
3. **æ¨¡å—åŠ è½½**: ä½¿ç”¨åŠ¨æ€ `import()` åŠ è½½ ES æ¨¡å—
4. **å®ä¾‹æ³¨å†Œ**: è‡ªåŠ¨æ³¨å†Œæ’ä»¶å®ä¾‹åˆ°æ¡†æ¶

åŠ è½½æµç¨‹ï¼š
```
å‘ç°æ‰©å±• â†’ éªŒè¯æ¸…å• â†’ åŠ è½½èµ„æº â†’ åˆ›å»ºå®ä¾‹ â†’ æ³¨å†Œåˆ°æ¡†æ¶ â†’ æ‰§è¡Œåˆå§‹åŒ–
```

## æ’ä»¶ç”Ÿå‘½å‘¨æœŸ

### ç”Ÿå‘½å‘¨æœŸé˜¶æ®µ
1. **Discovery**: æ’ä»¶å‘ç°å’Œæ‰«æ
2. **Loading**: æ’ä»¶åŠ è½½å’Œåˆå§‹åŒ–
3. **Activation**: æ’ä»¶æ¿€æ´»å’Œæ³¨å†Œ
4. **Running**: æ’ä»¶è¿è¡Œæ—¶ç®¡ç†
5. **Deactivation**: æ’ä»¶åœç”¨å’Œæ¸…ç†
6. **Unloading**: æ’ä»¶å¸è½½å’Œèµ„æºé‡Šæ”¾

### çŠ¶æ€è½¬æ¢å›¾
```
[Discovered] â†’ [Loaded] â†’ [Activated] â†’ [Running]
     â†“             â†“           â†“           â†“
[Error]      [Error]    [Deactivated] â†’ [Unloaded]
```

## æ’ä»¶æ¥å£å®šä¹‰

### æ ¸å¿ƒæ¥å£

#### IPlugin åŸºç¡€æ¥å£
```csharp
public interface IPlugin
{
    string Id { get; }
    string Name { get; }
    string Version { get; }
    string Description { get; }
    string Author { get; }
    
    Task<bool> InitializeAsync(IPluginContext context);
    Task<bool> StartAsync();
    Task<bool> StopAsync();
    Task<bool> UnloadAsync();
}
```

#### IPluginContext ä¸Šä¸‹æ–‡æ¥å£
```csharp
public interface IPluginContext
{
    IServiceProvider Services { get; }
    IConfiguration Configuration { get; }
    ILogger Logger { get; }
    IEventBus EventBus { get; }
    
    T GetService<T>() where T : class;
    void RegisterService<T>(T service) where T : class;
    void PublishEvent<T>(T eventData) where T : class;
    void SubscribeEvent<T>(Action<T> handler) where T : class;
}
```

### æ‰©å±•æ¥å£

#### IContentPlugin å†…å®¹æ’ä»¶æ¥å£
```csharp
public interface IContentPlugin : IPlugin
{
    string ContentType { get; }
    Task<ContentResult> CreateContentAsync(CreateContentRequest request);
    Task<ContentResult> UpdateContentAsync(UpdateContentRequest request);
    Task<ContentResult> DeleteContentAsync(DeleteContentRequest request);
    Task<ContentListResult> GetContentListAsync(GetContentListRequest request);
}
```

#### IUIPlugin ç•Œé¢æ’ä»¶æ¥å£
```csharp
public interface IUIPlugin : IPlugin
{
    IEnumerable<RouteInfo> GetRoutes();
    IEnumerable<MenuInfo> GetMenuItems();
    IEnumerable<ComponentInfo> GetComponents();
    string GetClientScript();
    string GetClientStyles();
}
```

## æ’ä»¶ç®¡ç†å™¨

### æ ¸å¿ƒåŠŸèƒ½
```csharp
public interface IPluginManager
{
    // æ’ä»¶å‘ç°å’ŒåŠ è½½
    Task<IEnumerable<PluginInfo>> DiscoverPluginsAsync();
    Task<bool> LoadPluginAsync(string pluginId);
    Task<bool> UnloadPluginAsync(string pluginId);
    
    // æ’ä»¶çŠ¶æ€ç®¡ç†
    Task<bool> ActivatePluginAsync(string pluginId);
    Task<bool> DeactivatePluginAsync(string pluginId);
    PluginStatus GetPluginStatus(string pluginId);
    
    // æ’ä»¶æŸ¥è¯¢
    IEnumerable<IPlugin> GetActivePlugins();
    T GetPlugin<T>(string pluginId) where T : class, IPlugin;
    IEnumerable<T> GetPlugins<T>() where T : class, IPlugin;
}
```

### æ’ä»¶å‘ç°æœºåˆ¶
1. **æ–‡ä»¶ç³»ç»Ÿæ‰«æ**: æ‰«ææŒ‡å®šç›®å½•ä¸‹çš„æ’ä»¶æ–‡ä»¶
2. **ç¨‹åºé›†åå°„**: é€šè¿‡åå°„æŸ¥æ‰¾å®ç°æ’ä»¶æ¥å£çš„ç±»
3. **é…ç½®æ–‡ä»¶**: é€šè¿‡é…ç½®æ–‡ä»¶æŒ‡å®šæ’ä»¶åˆ—è¡¨
4. **åœ¨çº¿å•†åº—ï¼ˆæ’ä»¶å®ç°ï¼‰**: ä»æ’ä»¶å•†åº—ä¸‹è½½å’Œå®‰è£…æ’ä»¶

## äº‹ä»¶æ€»çº¿ç³»ç»Ÿ

### äº‹ä»¶ç±»å‹
```csharp
// ç³»ç»Ÿäº‹ä»¶
public class SystemStartedEvent { }
public class SystemStoppingEvent { }

// ç”¨æˆ·äº‹ä»¶
public class UserRegisteredEvent 
{
    public int UserId { get; set; }
    public string Username { get; set; }
    public DateTime RegisterTime { get; set; }
}

// å†…å®¹äº‹ä»¶
public class ContentCreatedEvent
{
    public int ContentId { get; set; }
    public string ContentType { get; set; }
    public int AuthorId { get; set; }
    public DateTime CreateTime { get; set; }
}
```

### äº‹ä»¶æ€»çº¿æ¥å£
```csharp
public interface IEventBus
{
    // å‘å¸ƒäº‹ä»¶
    Task PublishAsync<T>(T eventData) where T : class;
    void Publish<T>(T eventData) where T : class;
    
    // è®¢é˜…äº‹ä»¶
    void Subscribe<T>(Func<T, Task> handler) where T : class;
    void Subscribe<T>(Action<T> handler) where T : class;
    
    // å–æ¶ˆè®¢é˜…
    void Unsubscribe<T>(Func<T, Task> handler) where T : class;
    void Unsubscribe<T>(Action<T> handler) where T : class;
}
```

## å‰ç«¯æ’ä»¶ç³»ç»Ÿå®ç°

### æ‰©å±•æ¡†æ¶åˆå§‹åŒ–
```typescript
// åˆ›å»ºå’Œåˆå§‹åŒ–æ‰©å±•æ¡†æ¶
const framework = createExtensionFramework({
  appName: 'VoxNest',
  logLevel: 'debug',
  autoRegisterBuiltins: true,
});

// æ³¨å†Œè‡ªå®šä¹‰é›†æˆ
framework.register(createCustomIntegration('my-plugin', {
  'components:ready': (context) => {
    context.slots.register('layout:header.right', {
      component: MyHeaderComponent,
      source: 'my-plugin',
      priority: 10,
    });
  }
}));

// åˆå§‹åŒ–æ¡†æ¶
await framework.initialize();
```

### æ‰©å±•ç±»å‹å®šä¹‰
```typescript
// æ‰©å±•æ¸…å•ç±»å‹
interface ExtensionManifest {
  id: string;
  name: string;
  version: string;
  author: string;
  description?: string;
  type: 'plugin' | 'theme';
  entry?: string;
  styles?: string[];
  scripts?: string[];
  dependencies?: string[];
  config?: Record<string, any>;
  enabled?: boolean;
}

// ç»„ä»¶æ³¨å†Œç±»å‹
interface ComponentRegistration {
  component: React.ComponentType<any>;
  source: string;
  priority?: number;
  condition?: (props?: any) => boolean;
  props?: Record<string, any>;
  name?: string;
  description?: string;
}
```

### æ§½ä½ä½¿ç”¨ç¤ºä¾‹
```tsx
import { Slot } from '@voxnest/extension-framework';

// åœ¨å¸ƒå±€ä¸­ä½¿ç”¨æ§½ä½
export const Layout: React.FC = ({ children }) => {
  return (
    <div className="app-layout">
      <header className="header">
        <div className="header-left">
          <Slot id="layout:header.left" />
        </div>
        <div className="header-center">
          <Slot id="layout:header.center" />
        </div>
        <div className="header-right">
          <Slot id="layout:header.right" />
        </div>
      </header>
      
      <main className="main">
        <aside className="sidebar">
          <Slot id="layout:sidebar.top" />
          <Slot id="layout:sidebar" />
          <Slot id="layout:sidebar.bottom" />
        </aside>
        
        <div className="content">
          <Slot id="layout:content.before" />
          {children}
          <Slot id="layout:content.after" />
        </div>
      </main>
      
      <footer className="footer">
        <Slot id="layout:footer" />
      </footer>
    </div>
  );
};
```

### æ‰©å±•å¼€å‘ç¤ºä¾‹
```typescript
// åˆ›å»ºç®€å•é›†æˆ
const myIntegration = createSimpleIntegration(
  'my-feature',
  (context) => {
    context.logger.info('My feature initialized!');
    // åˆå§‹åŒ–é€»è¾‘
  }
);

// åˆ›å»ºç»„ä»¶é›†æˆ
const myComponentIntegration = createComponentIntegration(
  'my-components',
  [
    {
      slotId: 'layout:header.right',
      component: MyHeaderWidget,
      priority: 5,
    },
    {
      slotId: 'layout:sidebar.top',
      component: MyNavigation,
      priority: 10,
    }
  ]
);

// æ³¨å†Œé›†æˆ
framework.register(myIntegration);
framework.register(myComponentIntegration);
```

## æ’ä»¶å®‰å…¨æœºåˆ¶

### æƒé™æ§åˆ¶
```csharp
public class PluginPermission
{
    public string PluginId { get; set; }
    public string Permission { get; set; }
    public bool IsGranted { get; set; }
}

public interface IPluginSecurity
{
    bool HasPermission(string pluginId, string permission);
    void GrantPermission(string pluginId, string permission);
    void RevokePermission(string pluginId, string permission);
    IEnumerable<string> GetRequiredPermissions(string pluginId);
}
```

### æ²™ç®±éš”ç¦»
- **ç¨‹åºé›†éš”ç¦»**: æ¯ä¸ªæ’ä»¶è¿è¡Œåœ¨ç‹¬ç«‹çš„ç¨‹åºé›†ä¸Šä¸‹æ–‡ä¸­
- **èµ„æºé™åˆ¶**: é™åˆ¶æ’ä»¶çš„CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨
- **APIè®¿é—®æ§åˆ¶**: åªå…è®¸è®¿é—®æˆæƒçš„APIå’ŒæœåŠ¡
- **æ–‡ä»¶ç³»ç»Ÿéš”ç¦»**: é™åˆ¶æ’ä»¶çš„æ–‡ä»¶è®¿é—®èŒƒå›´

## æ’ä»¶é…ç½®ç®¡ç†

### é…ç½®ç»“æ„
```json
{
  "plugins": {
    "blog-plugin": {
      "enabled": true,
      "version": "1.0.0",
      "settings": {
        "maxPostLength": 10000,
        "allowComments": true,
        "moderationEnabled": false
      }
    },
    "forum-plugin": {
      "enabled": true,
      "version": "2.1.0",
      "settings": {
        "maxTopicsPerPage": 20,
        "allowAnonymousPosts": false
      }
    }
  }
}
```

### é…ç½®æ¥å£
```csharp
public interface IPluginConfiguration
{
    T GetSetting<T>(string pluginId, string key, T defaultValue = default);
    void SetSetting<T>(string pluginId, string key, T value);
    void SaveSettings(string pluginId);
    void LoadSettings(string pluginId);
}
```

## æ’ä»¶å¼€å‘å·¥å…·åŒ…

### é¡¹ç›®æ¨¡æ¿
```bash
# åˆ›å»ºæ–°æ’ä»¶é¡¹ç›®
dotnet new voxnest-plugin -n MyPlugin

# é¡¹ç›®ç»“æ„
MyPlugin/
â”œâ”€â”€ MyPlugin.csproj
â”œâ”€â”€ Plugin.cs
â”œâ”€â”€ Controllers/
â”œâ”€â”€ Services/
â”œâ”€â”€ Models/
â”œâ”€â”€ Views/
â””â”€â”€ plugin.json
```

### å¼€å‘å·¥å…·
- **æ’ä»¶æ¨¡æ¿**: æ’ä»¶æ¨¡æ¿ä»“åº“éª¨æ¶
- **æ‰“åŒ…å·¥å…·**: æ’ä»¶æ‰“åŒ…å’Œå‘å¸ƒå·¥å…·

## æ€§èƒ½ä¼˜åŒ–

### å»¶è¿ŸåŠ è½½
- æŒ‰éœ€åŠ è½½æ’ä»¶æ¨¡å—
- å¼‚æ­¥åˆå§‹åŒ–éå…³é”®æ’ä»¶
- ç¼“å­˜æ’ä»¶å…ƒæ•°æ®

### èµ„æºç®¡ç†
- æ’ä»¶èµ„æºæ± åŒ–
- å†…å­˜ä½¿ç”¨ç›‘æ§
- åƒåœ¾å›æ”¶ä¼˜åŒ–

### å¹¶å‘æ§åˆ¶
- æ’ä»¶æ“ä½œçº¿ç¨‹å®‰å…¨
- å¼‚æ­¥äº‹ä»¶å¤„ç†
- èµ„æºç«äº‰é¿å…

---

## ğŸ†• æœ€æ–°æ¶æ„å‡çº§ â­ 2025å¹´9æœˆç‰ˆæœ¬

### æ‰©å±•ç®¡ç†ç³»ç»Ÿæ¶æ„

#### 1. å®æ—¶çŠ¶æ€ç®¡ç†æ¶æ„
```typescript
interface ExtensionStateManager {
  // æ‰©å±•çŠ¶æ€ç±»å‹
  status: 'active' | 'inactive' | 'loading' | 'error';
  
  // æ“ä½œçŠ¶æ€è·Ÿè¸ª
  operatingExtensions: Set<string>;
  
  // çŠ¶æ€æ›´æ–°æœºåˆ¶
  updateExtensionStatus(id: string, status: ExtensionStatus): void;
  
  // æ‰¹é‡çŠ¶æ€ç®¡ç†
  batchUpdateExtensions(updates: ExtensionUpdate[]): void;
}
```

#### 2. çƒ­é‡è½½ç³»ç»Ÿä¼˜åŒ–æ¶æ„
```typescript
class OptimizedHotReload {
  // é˜²æŠ–æœºåˆ¶
  private reloadTimers = new Map<string, number>();
  
  // é…ç½®ä¼˜åŒ–
  private config = {
    pollingInterval: 5000,    // é™ä½è½®è¯¢é¢‘ç‡
    debounceDelay: 2000,      // é˜²æŠ–å»¶è¿Ÿ
    maxRetries: 3,            // é‡è¯•æœºåˆ¶
    watchPatterns: [          // ç›‘æ§æ¨¡å¼
      '/src/extensions/**/*.{ts,tsx,js,jsx}',
      '!/extensions/extensions.json'  // æ’é™¤é…ç½®æ–‡ä»¶
    ]
  };
  
  // æ™ºèƒ½é‡è½½è°ƒåº¦
  scheduleReload(extensionId: string, reason: ReloadReason): void;
  
  // å†²çªæ£€æµ‹å’Œè§£å†³
  resolveReloadConflicts(): void;
}
```

#### 3. æ‰©å±•ç”Ÿå‘½å‘¨æœŸç®¡ç†
```mermaid
graph TD
    A[å‘ç°æ‰©å±•] --> B[éªŒè¯æ¸…å•]
    B --> C[åˆå§‹åŒ–æ‰©å±•]
    C --> D[æ³¨å†Œé›†æˆ]
    D --> E[å¯ç”¨æ‰©å±•]
    E --> F[è¿è¡Œæ—¶ç›‘æ§]
    F --> G{ç”¨æˆ·æ“ä½œ}
    G -->|å¯ç”¨/ç¦ç”¨| H[çŠ¶æ€åˆ‡æ¢]
    G -->|é‡è½½| I[çƒ­é‡è½½]
    G -->|å¸è½½| J[æ¸…ç†èµ„æº]
    H --> F
    I --> D
    J --> K[å®Œå…¨ç§»é™¤]
```

### ç»Ÿä¸€é…ç½®ç®¡ç†æ¶æ„

#### 1. é…ç½®å±‚çº§æ¶æ„
```yaml
# é…ç½®æ¶æ„å±‚çº§
VoxNest Configuration:
  â”œâ”€â”€ Frontend Settings
  â”‚   â”œâ”€â”€ Theme Configuration
  â”‚   â”œâ”€â”€ Layout Settings  
  â”‚   â”œâ”€â”€ Performance Options
  â”‚   â””â”€â”€ UX Optimization
  â”œâ”€â”€ Backend Configuration
  â”‚   â”œâ”€â”€ Server Settings
  â”‚   â”œâ”€â”€ Database Config
  â”‚   â”œâ”€â”€ CORS Configuration
  â”‚   â””â”€â”€ Logging Settings
  â””â”€â”€ Extension Configuration
      â”œâ”€â”€ Plugin Settings
      â”œâ”€â”€ Theme Variables
      â””â”€â”€ Integration Config
```

#### 2. é…ç½®åŒæ­¥æœºåˆ¶
```typescript
interface ConfigSyncManager {
  // é…ç½®æº
  sources: {
    frontend: FrontendConfigStore;
    backend: YAMLConfigService;
    extensions: ExtensionConfigRegistry;
  };
  
  // åŒæ­¥ç­–ç•¥
  syncStrategy: 'realtime' | 'batched' | 'manual';
  
  // å†²çªè§£å†³
  conflictResolution: ConfigConflictResolver;
  
  // å˜æ›´ä¼ æ’­
  propagateChanges(changes: ConfigChange[]): Promise<void>;
  
  // å›æ»šæœºåˆ¶
  rollback(checkpoint: ConfigCheckpoint): Promise<void>;
}
```

#### 3. å®æ—¶é…ç½®æ›´æ–°æµç¨‹
```mermaid
sequenceDiagram
    participant UI as ç”¨æˆ·ç•Œé¢
    participant API as é…ç½®API
    participant Store as é…ç½®å­˜å‚¨
    participant Cache as ç¼“å­˜å±‚
    participant App as åº”ç”¨å±‚
    
    UI->>API: é…ç½®æ›´æ–°è¯·æ±‚
    API->>Store: éªŒè¯å¹¶ä¿å­˜é…ç½®
    Store->>Cache: æ›´æ–°ç¼“å­˜
    API->>App: å¹¿æ’­é…ç½®å˜æ›´
    App->>UI: æ›´æ–°ç•Œé¢çŠ¶æ€
    API->>UI: è¿”å›æ“ä½œç»“æœ
```

### æ—¶åŒºä¸å›½é™…åŒ–æ¶æ„

#### 1. æ—¶åŒºæœåŠ¡æ¶æ„
```csharp
public interface ITimeZoneService
{
    // æ—¶åŒºå‘ç°
    Task<IEnumerable<TimeZoneInfo>> GetAvailableTimeZonesAsync();
    
    // æ—¶åŒºéªŒè¯
    Task<bool> ValidateTimeZoneAsync(string timeZoneId);
    
    // æ—¶åŒºè®¾ç½®
    Task<bool> SetTimeZoneAsync(string timeZoneId);
    
    // æ—¶åŒºè½¬æ¢
    Task<DateTime> ConvertToUserTimeZoneAsync(DateTime utcTime, string userTimeZone);
    
    // å½“å‰æ—¶åŒº
    Task<string> GetCurrentTimeZoneAsync();
}
```

#### 2. å›½é™…åŒ–æ‰©å±•æ¶æ„
```typescript
interface LocalizationFramework {
  // è¯­è¨€åŒ…ç®¡ç†
  languagePacks: Map<string, LanguagePack>;
  
  // åŠ¨æ€åŠ è½½
  loadLanguagePack(locale: string): Promise<LanguagePack>;
  
  // ç¿»è¯‘æœåŠ¡
  translate(key: string, params?: object): string;
  
  // æ ¼å¼åŒ–æœåŠ¡
  formatters: {
    date: DateFormatter;
    number: NumberFormatter;
    currency: CurrencyFormatter;
  };
  
  // æ‰©å±•å›½é™…åŒ–
  registerExtensionLocalization(
    extensionId: string, 
    localization: ExtensionLocalization
  ): void;
}
```

### æ€§èƒ½ä¼˜åŒ–æ¶æ„å‡çº§

#### 1. æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ
```typescript
class IntelligentCacheSystem {
  // å¤šçº§ç¼“å­˜
  private caches = {
    memory: new Map<string, CacheEntry>(),
    redis: new RedisCache(),
    localStorage: new LocalStorageCache()
  };
  
  // ç¼“å­˜ç­–ç•¥
  private strategies = {
    extensionMetadata: 'memory+redis',
    configurationData: 'memory+localStorage',
    userPreferences: 'localStorage',
    temporaryData: 'memory'
  };
  
  // æ™ºèƒ½å¤±æ•ˆ
  invalidateSmartly(pattern: string, reason: InvalidationReason): void;
  
  // é¢„çƒ­æœºåˆ¶
  preloadCriticalData(): Promise<void>;
}
```

#### 2. èµ„æºä¼˜åŒ–æ¶æ„
```typescript
interface ResourceOptimizer {
  // ä»£ç åˆ†å‰²
  codeSplitting: {
    chunkStrategy: 'extension' | 'feature' | 'route';
    lazyLoading: boolean;
    preloadCritical: boolean;
  };
  
  // èµ„æºå‹ç¼©
  compression: {
    gzip: boolean;
    brotli: boolean;
    imageOptimization: boolean;
  };
  
  // ç½‘ç»œä¼˜åŒ–
  networkOptimization: {
    http2: boolean;
    resourceHints: boolean;
    serviceWorker: boolean;
  };
}
```

### å®‰å…¨æ¶æ„å¢å¼º

#### 1. æ‰©å±•æ²™ç®±æœºåˆ¶
```typescript
class ExtensionSandbox {
  // æƒé™æ¨¡å‹
  private permissions = new PermissionManager({
    api: ['read', 'write', 'execute'],
    storage: ['local', 'session', 'indexeddb'],
    network: ['fetch', 'websocket'],
    dom: ['query', 'modify', 'event']
  });
  
  // èµ„æºéš”ç¦»
  private isolation = {
    memory: new MemoryIsolator(),
    storage: new StorageIsolator(),
    network: new NetworkIsolator()
  };
  
  // æ‰§è¡Œç¯å¢ƒ
  createIsolatedEnvironment(extensionId: string): IsolatedEnvironment;
  
  // æƒé™æ£€æŸ¥
  checkPermission(extensionId: string, action: Action): boolean;
}
```

#### 2. é…ç½®å®‰å…¨éªŒè¯
```csharp
public class ConfigurationSecurityValidator
{
    // é…ç½®éªŒè¯è§„åˆ™
    private readonly Dictionary<string, ValidationRule> _validationRules;
    
    // å®‰å…¨æ£€æŸ¥
    public async Task<ValidationResult> ValidateConfigurationAsync(
        object configuration, 
        ConfigurationType type)
    {
        // 1. ç±»å‹å®‰å…¨æ£€æŸ¥
        var typeValidation = await ValidateTypeAsync(configuration, type);
        
        // 2. å€¼èŒƒå›´éªŒè¯
        var rangeValidation = await ValidateRangesAsync(configuration);
        
        // 3. å®‰å…¨ç­–ç•¥æ£€æŸ¥
        var securityValidation = await ValidateSecurityPolicyAsync(configuration);
        
        return CombineValidationResults(typeValidation, rangeValidation, securityValidation);
    }
    
    // æ•æ„Ÿä¿¡æ¯è¿‡æ»¤
    public object FilterSensitiveInformation(object configuration)
    {
        // ç§»é™¤å¯†ç ã€å¯†é’¥ç­‰æ•æ„Ÿä¿¡æ¯
        // è¿”å›å®‰å…¨çš„é…ç½®å‰¯æœ¬
    }
}
```

### ç›‘æ§å’Œè¯Šæ–­æ¶æ„

#### 1. å®æ—¶ç›‘æ§ç³»ç»Ÿ
```typescript
interface RealTimeMonitoring {
  // æ€§èƒ½æŒ‡æ ‡
  performanceMetrics: {
    extensionLoadTime: Map<string, number>;
    memoryUsage: MemoryTracker;
    cpuUsage: CpuTracker;
    networkLatency: NetworkTracker;
  };
  
  // é”™è¯¯è¿½è¸ª
  errorTracking: {
    errorCount: Counter;
    errorTypes: Map<string, number>;
    stackTraces: ErrorLogger;
  };
  
  // ç”¨æˆ·è¡Œä¸ºåˆ†æ
  userBehaviorAnalytics: {
    extensionUsage: UsageTracker;
    featureAdoption: AdoptionTracker;
    performanceImpact: ImpactAnalyzer;
  };
}
```

#### 2. è¯Šæ–­å·¥å…·æ¶æ„
```typescript
class DiagnosticToolsFramework {
  // å¼€å‘è€…å·¥å…·
  private devTools = {
    extensionInspector: new ExtensionInspector(),
    performanceProfiler: new PerformanceProfiler(),
    memoryAnalyzer: new MemoryAnalyzer(),
    networkMonitor: new NetworkMonitor()
  };
  
  // è‡ªåŠ¨è¯Šæ–­
  private autoDiagnostics = {
    healthChecks: new HealthCheckRunner(),
    performanceTests: new PerformanceTestSuite(),
    compatibilityTests: new CompatibilityTester()
  };
  
  // é—®é¢˜æŠ¥å‘Š
  generateDiagnosticReport(): DiagnosticReport;
  
  // æ€§èƒ½å»ºè®®
  generatePerformanceRecommendations(): PerformanceRecommendation[];
}
```

## æ¶æ„æ¼”è¿›è·¯çº¿å›¾

### çŸ­æœŸç›®æ ‡ (2025å¹´Q4)
- âœ… ç»Ÿä¸€é…ç½®ç®¡ç†ç³»ç»Ÿå®Œå–„
- âœ… æ‰©å±•ç®¡ç†ä¼˜åŒ–å’Œç¨³å®šæ€§æå‡  
- âœ… æ—¶åŒºåŠŸèƒ½å’Œå›½é™…åŒ–åŸºç¡€
- ğŸ”„ æ’ä»¶å¸‚åœºåŸºç¡€æ¶æ„
- ğŸ”„ é«˜çº§æƒé™ç®¡ç†ç³»ç»Ÿ

### ä¸­æœŸç›®æ ‡ (2026å¹´Q1-Q2)
- ğŸ“‹ å¾®æœåŠ¡æ¶æ„è½¬å‹
- ğŸ“‹ äº‘åŸç”Ÿéƒ¨ç½²æ”¯æŒ
- ğŸ“‹ AIè¾…åŠ©æ’ä»¶å¼€å‘
- ğŸ“‹ å®æ—¶åä½œåŠŸèƒ½
- ğŸ“‹ é«˜çº§åˆ†æå’Œç›‘æ§

### é•¿æœŸç›®æ ‡ (2026å¹´Q3+)
- ğŸ“‹ è¾¹ç¼˜è®¡ç®—æ”¯æŒ
- ğŸ“‹ åŒºå—é“¾é›†æˆ
- ğŸ“‹ WebAssemblyæ’ä»¶æ”¯æŒ
- ğŸ“‹ è‡ªåŠ¨åŒ–æµ‹è¯•å’Œéƒ¨ç½²
- ğŸ“‹ å…¨çƒCDNåˆ†å‘