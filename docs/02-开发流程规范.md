# VoxNest 开发流程规范

## 开发环境搭建

### 必需工具
- **IDE**: Visual Studio 2022 / VS Code
- **数据库**: PostgreSQL 15+ / Mysql 8+
- **缓存**: Redis 7+（插件提供对接）
- **Node.js**: 18+ LTS
- **.NET**: 9.0 SDK

### 环境配置
```bash
# 1. 克隆项目
git clone <repository-url>
cd VoxNest

# 2. 安装前端依赖
cd voxnest.client
npm install

# 3. 配置数据库连接
# 编辑 VoxNest.Server/appsettings.Development.json

# 4. 运行数据库迁移
cd ../VoxNest.Server
dotnet ef database update

# 5. 启动开发服务器
dotnet run --project VoxNest.Server
cd ../voxnest.client && npm run dev
```

## Git 工作流

### 分支策略
- **main**: 生产环境分支，只接受经过测试的代码
- **develop**: 开发主分支，集成所有功能分支
- **feature/***: 功能开发分支
- **plugin/***: 插件开发分支
- **hotfix/***: 紧急修复分支

### 提交规范
使用 Conventional Commits 规范：

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

**类型说明：**
- `feat`: 新功能
- `fix`: 修复bug
- `docs`: 文档更新
- `style`: 代码格式调整
- `refactor`: 代码重构
- `test`: 测试相关
- `chore`: 构建过程或辅助工具的变动
- `plugin`: 插件相关

**示例：**
```
feat(auth): 添加JWT认证功能
fix(blog): 修复文章编辑器保存问题
plugin(forum): 新增论坛插件基础框架
```

## 代码规范

### C# 代码规范
- 使用 PascalCase 命名类、方法、属性
- 使用 camelCase 命名局部变量、参数
- 使用 EditorConfig 统一代码格式
- 必须编写XML文档注释

```csharp
/// <summary>
/// 用户服务接口
/// </summary>
public interface IUserService
{
    /// <summary>
    /// 根据ID获取用户信息
    /// </summary>
    /// <param name="userId">用户ID</param>
    /// <returns>用户信息</returns>
    Task<UserDto> GetUserByIdAsync(int userId);
}
```

### TypeScript 代码规范
- 使用 PascalCase 命名组件、接口、类型
- 使用 camelCase 命名变量、函数
- 使用 ESLint + Prettier 格式化代码
- 必须定义明确的类型

```typescript
interface UserProfile {
  id: number;
  username: string;
  email: string;
  avatar?: string;
}

const UserCard: React.FC<{ user: UserProfile }> = ({ user }) => {
  return (
    <div className="user-card">
      <h3>{user.username}</h3>
      <p>{user.email}</p>
    </div>
  );
};
```

## CI/CD 流程

### 部署流程
1. **开发环境**: 自动部署 develop 分支
2. **测试环境**: 手动部署 feature 分支
3. **生产环境**: 手动部署 main 分支

## 代码审查

### 审查清单
- [ ] 代码符合规范
- [ ] 功能实现正确
- [ ] 测试覆盖充分
- [ ] 性能影响评估
- [ ] 安全性检查
- [ ] 文档更新完整

### 审查流程
1. 开发者提交 Pull Request
2. 自动运行 CI 检查
3. 至少2名审查者 Review
4. 修复审查意见
5. 合并到目标分支

## 发布管理

### 版本号规范
使用语义化版本号：`MAJOR.MINOR.PATCH`

- **MAJOR**: 不兼容的API修改
- **MINOR**: 向下兼容的功能性新增
- **PATCH**: 向下兼容的问题修正

### 发布流程
1. 创建 release 分支
2. 更新版本号和 CHANGELOG
3. 执行完整测试套件
4. 创建 Git Tag
5. 部署到生产环境
6. 发布 Release Notes
